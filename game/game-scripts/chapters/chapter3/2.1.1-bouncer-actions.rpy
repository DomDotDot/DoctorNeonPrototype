# --- ПАЗЛ "РАЗГНЕВАЙ ГИГАНТА" ---

label ch3_bouncer_talk_menu:
    show neon neutral at right with dissolve
    menu:
        # Обычные разговоры, доступные до 4-х раз
        "Попросить выпустить." if bouncer_talk_count < 4:
            jump ch3_bouncer_plead

        # Провокация становится доступной только после посещения лестницы
        "Подстрекать вышибалу." if can_provoke and provocation_count < 1:
            jump ch3_provoke_verbal

        "Накинуть простыню на вышибалу." if has_torn_sheet and provocation_count == 1:
            jump ch3_provoke_sheet

        # Секретный вариант, открывается после подслушивания бандитов
        "Рассказать о его дочери." if knows_bouncer_secret:
            jump ch3_provoke_secret
        
        "Вернуться.":
            jump ch3_hall_explore

### НОВОЕ: Цепочка обычных диалогов ###
label ch3_bouncer_plead:
    if bouncer_talk_count == 0:
        neon shy "Послушайте, мне нужно выйти. Пожалуйста."
        "Вышибала" "Босс сказал ждать. Значит, будешь ждать."
    elif bouncer_talk_count == 1:
        neon neutral "Я не хочу проблем. Просто откройте дверь."
        "Вышибала" "Проблемы начнутся, если ты не заткнешься. Я сказал нет."
    elif bouncer_talk_count == 2:
        neon pouty "Может, мы договоримся? Я могу..."
        "Вышибала" "Проваливай от меня, пока я добрый."
    elif bouncer_talk_count == 3:
        neon pouty "Еще один раз прошу..."
        "Вышибала" "..."
        narrator "Он перестал реагировать. Просто смотрит в стену, игнорируя меня. Дальнейшие уговоры бесполезны."

    $ bouncer_talk_count += 1
    jump ch3_bouncer_talk_menu



label ch3_provoke_verbal:

    "Вышибала" "Чего уставилась, умница?"
    neon smirk "Просто провожу наблюдение. Хочу проверить гипотезу: ваша мышечная масса обратно пропорциональна скорости нейронной реакции? Судя по вашему выражению лица, я на верном пути."
    "Вышибала" "Ч-Чего? Кончай умничать, а то я тебе твою гипотезу в глотку засуну."
    narrator "Он явно разозлился. Отлично. Первый шаг сделан."
    $ provocation_count += 1
    jump ch3_hall_explore


label ch3_provoke_secret:
    show neon smirk with Dissolve(5.0)
    neon @ smirk "Ну как твоя дочь поживает? Я про то, что с ней сделал туман. В коме, да?"
    "Вышибала" "Что ты сказала?!"
    neon "И про то, как тебе нужны деньги. Думаешь, Гатс тебе поможет? Он бросит тебя, как только ты перестанешь быть ему нужен. Как и все остальные."
    narrator "Я попала в самое больное место. Его лицо исказилось от ярости и боли. Гранитная маска треснула."
    "Вышибала" "ЗАМОЛЧИ!"
    $ provocation_count = 3 # Сразу максимальный уровень провокации
    jump ch3_chase_start

label ch3_provoke_sheet:
    narrator """
    Я подхожу к нему, пряча рваную простыню за спиной.
    На моем лице – самая невинная и игривая улыбка, на которую я только способна.
    """
    # play sound "sounds/cloth_whoosh.ogg"
    narrator "Резким, отточенным движением я набрасываю ткань ему на голову."

    # play sound "sounds/muffled_grunt.ogg"
    "Вышибала" "А?! Какого черта?!"
    narrator "Он взревел, слепо молотя руками по воздуху, пытаясь сорвать с себя ткань, запутавшуюся в его огромных плечах."

    narrator """
    Мой шанс!
    
    Пока он дезориентирован, я бросаюсь к выходу. Пальцы уже почти касаются холодной стали дверной ручки...
    """
    # play sound "sounds/cloth_grab_quick.ogg"
    narrator "Но тут стальная хватка сжимает ворот моего халата. Меня резко дергают назад и отрывают от пола."

    "Вышибала" "СЛУШАЙ СЮДА, ЕСЛИ ЕЩЁ РАЗ ПОДОБНОЕ ЧТО-ТО СОТВОРИШЬ - КИШКИ РАСПОРЮ. БОСС НА ЭТО ДАЖЕ НЕ ПОСМОТРИТ."
    "Вышибала" "ЯСНО?!" with vpunch

    # play sound "sounds/body_thud_light.ogg"
    narrator "Он грубо ставит меня на пол. Я едва удерживаюсь на ногах, сердце колотится в горле."
    
    "Вышибала" "...тебе очень повезло, что ты так на нее похожа..."

    narrator """
    Он отворачивается, бормоча что-то себе под нос, и возвращается на свой пост, оставляя меня в растерянности.

    Второй шаг сделан. Он на грани. Еще один толчок, и эта стена рухнет.
    """
    $ provocation_count += 1
    jump ch3_hall_explore